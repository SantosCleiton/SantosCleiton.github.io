<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <title>Exemplo 3DS Safe2Pay</title>
    <script src="https://static.safe2pay.dev/scripts/verify_3DS2.min.js"></script>
    <style>
      body {
        font-family: system-ui, sans-serif;
        background-color: #f5f5f5;
        margin: 0;
        padding: 2rem;
        display: flex;
        justify-content: center;
      }
 
      .container {
        background: white;
        padding: 2rem;
        border-radius: 8px;
        box-shadow: 0 0 8px rgba(0, 0, 0, 0.05);
        max-width: 360px;
        width: 100%;
      }
 
      h2 {
        text-align: center;
        margin-bottom: 0.5rem;
      }
 
      .env {
        text-align: center;
        font-size: 0.9rem;
        margin-bottom: 1.5rem;
        color: #666;
      }
 
      label {
        display: block;
        margin: 0.5rem 0 0.25rem;
        font-weight: 500;
      }
 
      input[type="text"],
      select {
        width: 100%;
        padding: 0.5rem;
        font-size: 1rem;
        border: 1px solid #ccc;
        border-radius: 5px;
        margin-bottom: 0.75rem;
      }
 
      input[type="button"] {
        width: 100%;
        padding: 0.75rem;
        background-color: #007bff;
        color: white;
        font-weight: bold;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        margin-top: 1rem;
      }
 
      input[type="button"]:disabled {
        background-color: #aaa;
        cursor: not-allowed;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h2>Exemplo 3DS Safe2Pay</h2>
 
      <label for="envSelector">Ambiente:</label>
      <select id="envSelector">
        <option value="true">Sandbox</option>
        <option value="false">Produção</option>
      </select>
 
      <label for="txtCardAlias">Nome impresso no cartão</label>
      <input type="text" id="txtCardAlias" value="JOAO DA SILVA" />
 
      <label for="txtCardNumber">Número do cartão</label>
      <input type="text" id="txtCardNumber" value="4000000000001091" />
 
      <label for="drpInstallments">Parcelas</label>
      <select id="drpInstallments">
        <option value="01">1x</option>
        <option value="02">2x</option>
        <option value="03">3x</option>
        <option value="04">4x</option>
        <option value="05">5x</option>
        <option value="06">6x</option>
        <option value="07">7x</option>
        <option value="08">8x</option>
        <option value="09">9x</option>
        <option value="10">10x</option>
        <option value="11">11x</option>
        <option value="12">12x</option>
      </select>
 
      <label for="drpCardExpirationMonth">Mês de Vencimento</label>
      <select id="drpCardExpirationMonth">
        <option value="01">Janeiro</option>
        <option value="02">Fevereiro</option>
        <option value="03">Março</option>
        <option value="04">Abril</option>
        <option value="05">Maio</option>
        <option value="06">Junho</option>
        <option value="07">Julho</option>
        <option value="08">Agosto</option>
        <option value="09">Setembro</option>
        <option value="10">Outubro</option>
        <option value="11">Novembro</option>
        <option value="12">Dezembro</option>
      </select>
 
      <label for="drpCardExpirationYear">Ano de Vencimento</label>
      <select id="drpCardExpirationYear">
        <option value="25">2025</option>
        <option value="26">2026</option>
        <option value="27">2027</option>
        <option value="28">2028</option>
        <option value="29">2029</option>
        <option value="30">2030</option>
        <option value="31">2031</option>
        <option value="32">2032</option>
        <option value="33">2033</option>
      </select>
 
      <input id="btnSendOrder" value="Processar Pagamento" type="button" disabled />
    </div>
 
    <script>
      let config = {
        IsEnabled: true,
        IsSandbox: true,
        IsDebug: true,
        IsChallengeSuppressed: false
      };
 
      const amount = 5.00;
 
      function initMpi() {
        Safe2Pay.Mpi.Init(config, amount);
        document.getElementById("btnSendOrder").disabled = true;
      }
 
      document.getElementById("envSelector").addEventListener("change", function () {
        config.IsSandbox = this.value === "true";
        initMpi();
      });
 
      Safe2Pay.Mpi.addEventListener("onReady", function () {
        document.getElementById("btnSendOrder").disabled = false;
      });
 
      Safe2Pay.Mpi.addEventListener("onSuccess", function (e) {
        var cavv = e.Cavv;
        var xid = e.Xid;
        var eci = e.Eci;
        var version = e.Version;
        var referenceId = e.ReferenceId;
      });
 
      Safe2Pay.Mpi.addEventListener("onUnenrolled", function (e) {});
      Safe2Pay.Mpi.addEventListener("onFailure", function (e) {});
      Safe2Pay.Mpi.addEventListener("onError", function (e) {});
      Safe2Pay.Mpi.addEventListener("onDisabled", function () {});
      Safe2Pay.Mpi.addEventListener("onUnsupportedBrand", function () {});
 
      document.getElementById("btnSendOrder").addEventListener("click", function () {
        const paymentObject = {
          currency: "BRL",
          installments: document.getElementById("drpInstallments").value,
          cardnumber: document.getElementById("txtCardNumber").value,
          cardexpirationmonth: document.getElementById("drpCardExpirationMonth").value,
          cardexpirationyear: document.getElementById("drpCardExpirationYear").value,
          cardalias: document.getElementById("txtCardAlias").value
        };
        Safe2Pay.Mpi.Checkout(paymentObject);
      });
 
      // Inicializa na primeira carga
      initMpi();
    </script>
  </body>
</html>
