<!DOCTYPE html>
<html>
  <head>
    <script src="https://static.safe2pay.dev/scripts/verify_3DS2.min.js"></script>
  </head>
  <body>
    <h2>Exemplo 3DS</h2>
    <div>
      <label for="txtCardAlias">Nome impresso no cartão</label>
      <input type="text" id="txtCardAlias" value="JOAO DA SILVA" style="width: 300px" />
      <label for="txtCardNumber">Número do cartão</label>
      <input type="text" id="txtCardNumber" value="4000000000001091" style="width: 300px" />
      <label for="drpInstallments">Parcelas</label>
      <select id="drpInstallments" style="width: 300px">
        <option value="01">1x</option>
        <option value="02">2x</option>
        <option value="03">3x</option>
        <option value="04">4x</option>
        <option value="05">5x</option>
        <option value="06">6x</option>
        <option value="07">7x</option>
        <option value="08">8x</option>
        <option value="09">9x</option>
        <option value="10">10x</option>
        <option value="11">11x</option>
        <option value="12">12x</option>
      </select>
      <label for="drpCardExpirationMonth">Mês de Vencimento</label>
      <select id="drpCardExpirationMonth" style="width: 300px">
        <option value="01">Janeiro</option>
        <option value="02">Fevereiro</option>
        <option value="03">Março</option>
        <option value="04">Abril</option>
        <option value="05">Maio</option>
        <option value="06">Junho</option>
        <option value="07">Julho</option>
        <option value="08">Agosto</option>
        <option value="09">Setembro</option>
        <option value="10">Outubro</option>
        <option value="11">Novembro</option>
        <option value="12">Dezembro</option>
      </select>
      <label for="drpCardExpirationYear">Ano de Vencimento</label>
      <select id="drpCardExpirationYear" style="width: 300px">
        <option value="26">2026</option>
        <option value="27">2027</option>
        <option value="27">2028</option>
        <option value="27">2029</option>
      </select>
    </div>
    <input id="btnSendOrder" value="Processar Pagamento" type="button" disabled="disabled" />
    <script>
      Safe2Pay.Mpi.addEventListener("onReady", function(e) {
        document.getElementById("btnSendOrder").disabled = false;
      });
      Safe2Pay.Mpi.addEventListener("onSuccess", function(e) {
        var cavv = e.Cavv; // Dado que representa assinatura da autenticação	
        var xid = e.Xid; // ID que representa a requisição da autenticação	
        var eci = e.Eci; // Código indicador do e-commerce, que representa o resultado da autenticação		
        var version = e.Version; // Versão do 3DS utilizado no processo de autenticação	
        var referenceId = e.ReferenceId; // RequestID retornado no processo de autenticação
      });
      Safe2Pay.Mpi.addEventListener("onUnenrolled", function(e) {
        // Cartão não elegível para autenticação (não autenticável).
        var xid = e.Xid; // ID que representa a requisição da autenticação		
        var eci = e.Eci; // Código indicador do e-commerce, que representa o resultado da autenticação	
        var version = e.Version; // Versão do 3DS utilizado no processo de autenticação	
        var referenceId = e.ReferenceId; // RequestID retornado no processo de autenticação
      });
      Safe2Pay.Mpi.addEventListener("onFailure", function(e) {
        var xid = e.Xid; // ID que representa a requisição da autenticação	
        var eci = e.Eci; // Código indicador do e-commerce, que representa o resultado da autenticação	
        var version = e.Version; // Versão do 3DS utilizado no processo de autenticação	
        var referenceId = e.ReferenceId; // RequestID retornado no processo de autenticação	
      });
      Safe2Pay.Mpi.addEventListener("onError", function(e) {
        var xid = e.Xid; // ID que representa a requisição da autenticação	
        var eci = e.Eci; // Código indicador do e-commerce, que representa o resultado da autenticação	
        var returnCode = e.ReturnCode; // Código de retorno da requisição de autenticação	
        var returnMessage = e.ReturnMessage; // Mensagem de retorno da requisição de autenticação	
        var referenceId = e.ReferenceId; // RequestID retornado no processo de autenticação	
      });
      Safe2Pay.Mpi.addEventListener("onDisabled", function() {
        // Loja não requer autenticação do portador (classe "bpmpi_auth" false -> autenticação desabilitada).
      });
      Safe2Pay.Mpi.addEventListener("onUnsupportedBrand", function() {
        // Bandeira não suportada para autenticação.
        var returnCode = e.ReturnCode; // Mensagem de retorno da requisição de autenticação	
        var returnMessage = e.ReturnMessage; // RequestID retornado no processo de autenticação
      });
      var config = {
        IsEnabled: true,
        IsSandbox: true,
        IsDebug: true,
        IsChallengeSuppressed: false
      };
      let amount = 122.11;
      Safe2Pay.Mpi.Init(config, amount);
      document.getElementById("btnSendOrder").addEventListener("click", function() {
        let paymentObject = {
          currency: "BRL",
          installments: document.getElementById('drpInstallments').value,
          cardnumber: document.getElementById('txtCardNumber').value,
          cardexpirationmonth: document.getElementById('drpCardExpirationMonth').value,
          cardexpirationyear: document.getElementById('drpCardExpirationYear').value,
          cardalias: document.getElementById('txtCardAlias').value
        };
        Safe2Pay.Mpi.Checkout(paymentObject);
      });
    </script>
  </body>
</html>
